---
import SnippetCard from "@/components/cards/snippet-card.astro";
import MainLayout from "@/layouts/main-layout.astro";
import { getGuides } from "@/lib/fetchers";
import { buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { siteConfig } from "@/config/site";

const guides = await getGuides();

// Generate CollectionPage schema markup for snippets index
const snippetsIndexLd = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  name: "Code Snippets - Yokesh K.S.",
  description:
    "Ready-to-use code snippets and components for modern web development",
  url: `${siteConfig.url}/snippets`,
  author: {
    "@type": "Person",
    name: "Yokesh K.S.",
    url: siteConfig.url,
  },
  mainEntity: {
    "@type": "ItemList",
    name: "Code Snippets Collection",
    description:
      "Collection of ready-to-use code snippets and components for modern web development",
    numberOfItems: guides.length,
    itemListElement: guides.map((guide, index) => ({
      "@type": "ListItem",
      position: index + 1,
      item: {
        "@type": "HowTo",
        name: guide.data.title,
        description: guide.data.description,
        url: `${siteConfig.url}/snippets/${guide.id}`,
        author: {
          "@type": "Person",
          name: "Yokesh K.S.",
          url: siteConfig.url,
        },
        publisher: {
          "@type": "Person",
          name: "Yokesh K.S.",
          url: siteConfig.url,
        },

        mainEntityOfPage: {
          "@type": "WebPage",
          "@id": `${siteConfig.url}/snippets/${guide.id}`,
        },
      },
    })),
  },
  breadcrumb: {
    "@type": "BreadcrumbList",
    itemListElement: [
      {
        "@type": "ListItem",
        position: 1,
        name: "Home",
        item: siteConfig.url,
      },
      {
        "@type": "ListItem",
        position: 2,
        name: "Snippets",
        item: `${siteConfig.url}/snippets`,
      },
    ],
  },
};
---

<MainLayout title="Snippets" description="Ready-to-use code snippets and components for modern web development">
  <!-- Snippets Section -->
  <section class="py-16 ">
    <div class="container max-w-6xl mx-auto">
      {guides?.length ? (
        <>
      <div class="my-12">
        <h2 class="font-heading text-2xl font-bold">Snippets</h2>
      </div>

          <!-- Snippets Grid -->
          <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {guides.map((guide) => (
              <SnippetCard {...guide} />
            ))}
          </div>
        </>
      ) : (
        <!-- Empty State -->
        <div class="text-center py-16">
          <div class="w-24 h-24 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-2xl flex items-center justify-center text-4xl mb-6 mx-auto">
            ðŸ’»
          </div>
          <h3 class="font-heading text-2xl font-bold mb-4">
            Code Snippets Coming Soon
          </h3>
          <p class="text-muted-foreground text-lg mb-8 max-w-md mx-auto">
            I'm preparing a collection of useful code snippets and components. Check back soon for ready-to-use code that will accelerate your development.
          </p>
          <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
            <a
              href="mailto:ksyokesh98@gmail.com?subject=Snippet Request"
              class={cn(buttonVariants({ size: "lg" }), "bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white border-0 shadow-lg hover:shadow-2xl hover:scale-105 transition-all duration-300")}
            >
              Request a Snippet
            </a>
            <a
              href="/projects"
              class={cn(buttonVariants({ size: "lg", variant: "outline" }), "border-indigo-200 dark:border-indigo-800 hover:bg-indigo-50 dark:hover:bg-indigo-950 hover:border-indigo-400 dark:hover:border-indigo-600 hover:scale-105 transition-all duration-300")}
            >
              View Projects
            </a>
          </div>
        </div>
      )}
    </div>
  </section>
</MainLayout>

<script type="application/ld+json" set:html={JSON.stringify(snippetsIndexLd)} />
