---
import BlogCard from "@/components/cards/blog-card.astro";
import MainLayout from "@/layouts/main-layout.astro";
import { getPosts } from "@/lib/fetchers";
import { buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { siteConfig } from "@/config/site";

const posts = await getPosts();

// Generate Blog schema markup for blog index page
const blogIndexLd = {
  "@context": "https://schema.org",
  "@type": "Blog",
  name: "Yokesh K.S. Blog",
  description:
    "Insights on AI development, web technologies, and software engineering from Yokesh K.S., Lead Frontend Engineer building intelligent systems.",
  url: `${siteConfig.url}/blog`,
  author: {
    "@type": "Person",
    name: "Yokesh K.S.",
    url: siteConfig.url,
    image: `${siteConfig.url}/profile.jpeg`,
  },
  publisher: {
    "@type": "Person",
    name: "Yokesh K.S.",
    url: siteConfig.url,
  },
  mainEntityOfPage: {
    "@type": "WebPage",
    "@id": `${siteConfig.url}/blog`,
  },
  blogPost: posts.map((post) => ({
    "@type": "BlogPosting",
    headline: post.data.title,
    url: `${siteConfig.url}/blog/${post.id}`,
    datePublished: post.data.pubDate.toISOString(),
    dateModified: post.data.updatedDate
      ? post.data.updatedDate.toISOString()
      : post.data.pubDate.toISOString(),
    description: post.data.description,
    author: {
      "@type": "Person",
      name: "Yokesh K.S.",
      url: siteConfig.url,
    },
  })),
  breadcrumb: {
    "@type": "BreadcrumbList",
    itemListElement: [
      {
        "@type": "ListItem",
        position: 1,
        name: "Home",
        item: siteConfig.url,
      },
      {
        "@type": "ListItem",
        position: 2,
        name: "Blog",
        item: `${siteConfig.url}/blog`,
      },
    ],
  },
};
---

<MainLayout title="Blog by Yokesh K S | Lead Frontend Engineer" description="Read insights on AI development, web technologies, and software engineering from Yokesh K S, Lead Frontend Engineer building intelligent systems.">

  <!-- Blog Posts Section -->
  <section class="py-8 sm:py-16 lg:py-24">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      {posts.length > 0 ? (
        <>
          <div class="mx-auto mb-12 flex max-w-2xl flex-col items-center justify-center space-y-4 text-center sm:mb-16 lg:mb-24">
            <h2 class="font-semibold text-2xl md:text-3xl lg:text-4xl">All Articles</h2>
            <p class="text-muted-foreground text-xl">
              Insights on AI development, web technologies, and software engineering.
            </p>
          </div>
          <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
            {posts.map((post) => (
              <BlogCard {...post} />
            ))}
          </div>
        </>
      ) : (
        <div class="text-center py-16">
          <h3 class="font-semibold text-2xl mb-4">
            No Blog Posts Yet
          </h3>
          <p class="text-muted-foreground text-lg mb-8 max-w-md mx-auto">
            I'm working on some exciting content about AI development and modern web technologies. Stay tuned!
          </p>
          <a
            href="/"
            class={cn(buttonVariants({ variant: "outline" }))}
          >
            Back to Home
          </a>
        </div>
      )}
    </div>
  </section>
</MainLayout>

<script type="application/ld+json" set:html={JSON.stringify(blogIndexLd)} />
