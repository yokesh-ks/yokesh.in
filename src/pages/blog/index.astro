---
import BlogCard from "@/components/cards/blog-card.astro";
import MainLayout from "@/layouts/main-layout.astro";
import { getPosts } from "@/lib/fetchers";
import { buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { siteConfig } from "@/config/site";

const posts = await getPosts();

// Generate Blog schema markup for blog index page
const blogIndexLd = {
  "@context": "https://schema.org",
  "@type": "Blog",
  name: "Yokesh K.S. Blog",
  description:
    "Insights on AI development, web technologies, and software engineering from Yokesh K.S., Lead Frontend Engineer building intelligent systems.",
  url: `${siteConfig.url}/blog`,
  author: {
    "@type": "Person",
    name: "Yokesh K.S.",
    url: siteConfig.url,
    image: `${siteConfig.url}/profile.jpeg`,
  },
  publisher: {
    "@type": "Person",
    name: "Yokesh K.S.",
    url: siteConfig.url,
  },
  mainEntityOfPage: {
    "@type": "WebPage",
    "@id": `${siteConfig.url}/blog`,
  },
  blogPost: posts.map((post) => ({
    "@type": "BlogPosting",
    headline: post.data.title,
    url: `${siteConfig.url}/blog/${post.id}`,
    datePublished: post.data.pubDate.toISOString(),
    dateModified: post.data.updatedDate
      ? post.data.updatedDate.toISOString()
      : post.data.pubDate.toISOString(),
    description: post.data.description,
    author: {
      "@type": "Person",
      name: "Yokesh K.S.",
      url: siteConfig.url,
    },
  })),
  breadcrumb: {
    "@type": "BreadcrumbList",
    itemListElement: [
      {
        "@type": "ListItem",
        position: 1,
        name: "Home",
        item: siteConfig.url,
      },
      {
        "@type": "ListItem",
        position: 2,
        name: "Blog",
        item: `${siteConfig.url}/blog`,
      },
    ],
  },
};
---

<MainLayout title="Blog by Yokesh K S | Lead Frontend Engineer" description="Read insights on AI development, web technologies, and software engineering from Yokesh K S, Lead Frontend Engineer building intelligent systems.">

  <!-- Blog Posts Section -->
  <section class="py-16">
    <div class="container max-w-6xl my-12 mx-auto">
      {posts.length > 0 ? (
        <>
          <!-- Blog Posts Grid -->
          <div class="mb-8">
            <h2 class="font-heading text-2xl font-bold mb-6">
              Recent <span class="text-gradient_indigo-purple">Articles</span>
            </h2>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {posts.map((post) => (
              <BlogCard {...post} />
            ))}
          </div>
        </>
      ) : (
        <!-- Empty State -->
        <div class="text-center py-16">
          <div class="w-24 h-24 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-2xl flex items-center justify-center text-4xl mb-6 mx-auto">
            üìù
          </div>
          <h3 class="font-heading text-2xl font-bold mb-4">
            No Blog Posts Yet
          </h3>
          <p class="text-muted-foreground text-lg mb-8 max-w-md mx-auto">
            I'm working on some exciting content about AI development and modern web technologies. Stay tuned!
          </p>
          <a
            href="/"
            class={cn(buttonVariants({ variant: "outline" }), "border-indigo-200 dark:border-indigo-800 hover:bg-indigo-50 dark:hover:bg-indigo-950 hover:border-indigo-400 dark:hover:border-indigo-600 transition-all duration-300")}
          >
            Back to Home
          </a>
        </div>
      )}
    </div>
  </section>
</MainLayout>

<script type="application/ld+json" set:html={JSON.stringify(blogIndexLd)} />
